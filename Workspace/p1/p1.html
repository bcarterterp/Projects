<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head>


  <title>CMSC 430, Spring 2011</title>
                                  
  <meta http-equiv="content-type" content="text/html; charset=ISO-8859-1">
  <link href="style.css" rel="stylesheet" type="text/css">
</head><body>

<table cellpadding="8" cellspacing="0" width="100%">
<tbody><tr>
<td valign="top" width="15%">
<table class="menu" border="0" cellpadding="2" cellspacing="2" width="100%">
  <tbody>
      <tr><td><a href="http://www.cs.umd.edu/class/spring2011/cmsc430/">Home</a></td></tr>
      <tr><td><a href="http://www.cs.umd.edu/class/spring2011/cmsc430/syllabus.shtml">Syllabus</a></td></tr>
      <tr><td><a href="http://www.cs.umd.edu/class/spring2011/cmsc430/schedule.shtml">Schedule<br> <i>(w/ links to handouts)</i></a></td></tr>
      <tr><td><a href="http://www.cs.umd.edu/class/spring2011/cmsc430/resources.shtml">Resources</a></td></tr>
      <tr><td><a href="https://forum.cs.umd.edu/forumdisplay.php?f=235">Forum</a></td></tr>
      <tr><td><a href="https://submit.cs.umd.edu/">Submit Server</a></td></tr>
      <tr><td><a href="https://grades.cs.umd.edu/">Grades Server</a></td></tr>
  </tbody>
</table>
</td><td valign="top" width="85%">

<div class="header">
<center>
<h2>CMSC 430, Spring 2011</h2>
<h3>Introduction to Compilers</h3>
</center>
</div>





<h1 class="title">Project 1 - C-- Scanner & Parser</h1>
<center>
Due 11:59pm Thursday, Feb 17th, 2011 <br>
</center>

<p>
<h2>Introduction</h2>

<p>
This project is the first in the series of projects that you have to 
implement in order to build a compiler for 'C--', a variant of 'C'. 
Your compiler will scan, parse, type check, and eventually generate 
optimized Java class files from input C-- programs. 
In this project you will implement the compiler front end 
(scanner & parser) for C--. 

<p>
<h2>Getting Started</h2>

Project 1 will be implemented in Java in Eclipse. 
Download the following file:

<ul>
<li> Eclipse project archive file <a href="p1.zip">p1.zip</a>
</ul>

You can import the project into Eclipse as an existing project 
in an archive file. 

<p>
Before making any changes to your code, make sure you can run 
the code in StudentTests.java (applies skeleton scanner/parser 
to toy1.c and toy2.c).  Remember that each time you build your
compiler you will need to run the code as an application, apply
"Refresh" to the entire project so Eclipse can find the 
files generated by JLex and CUP, then rerun your code.

<p>
Along with files used to make direct submissions to the
submit server (submit.jar, <a href=".submit">.submit</a>), you will
find the following project files:
</p><ul>
<li>Scanner specification for JLex - <a href="mycc.lex">mycc.lex</a>
<li>Parser specification for Cup - <a href="mycc.cup">mycc.cup</a>
</ul>

<p>
</p><h2>C-- Language Syntax</h2>

<ul>
<li> Comments<p>

    // Ignore to the end of line

<li>
Data types: int & void. There can be arrays of int.<p>

   There are no explicit boolean variables, but expressions
   may have type boolean if they are the result of a comparison.

<li>
Operators include: <p>
<ul>
<li> arithmetic:    +, -, *, /
<li> relational:    ==, !=, <, >
<li> logical:       &&, ||, !
</ul>
<p>

   All binary arithmetic and logical operators are left-associative.
   NOT (!) and UNARY_MINUS (-) are not associative.  I.e., (- - 2)
   is illegal; you must use -(-2).  Arithmetic operators require
   integer operands, logical operators require boolean operands,
   The relational operators == and != work on both bool & int.  
   The relational operators < and > work on only int.  Relational
   operators ==, !=, <, > all return a boolean.

<p>
   The operators have the following precedence: 
<p>

<table border="1">
<tr>
<td>	Highest</td>    <td align="center">! (unary minus)
<tr>
<td></td>                     <td align="center"> * /
<tr>
<td></td>                     <td align="center"> + -
<tr>
<td></td>                     <td align="center"> == != > <
<tr>
<td>          Lowest</td>     <td align="center">&& ||
<tr>
</table>
     
<p>
   You have to assign the appropriate precedences in CUP.
<p>

   All math operators (+, -, *, /) and comparisons (<, >) 
   are defined for only integers. Logical operators (&&, ||, !) apply 
   only to results of comparisons (booleans).  == and != apply to both
   booleans and integers.
<p>

<li>
Control Statements:<p>

   C-- provides three control statements, if, if-else, and while.
<p>

<pre>
   if ( condition )
   {
     statement_list;
   }

   if ( condition )
   {
     statement_list;
   }
   else
   {
     statement_list;
   }

   while ( condition )
   {
     statement_list;
   }
</pre>
</ul>

<p>
   There can be any level of nesting of these control statements.
   Curly braces are required for all C-- control statements.
<p>

   For example, the code
<p>
  
<pre>
   if (x != 0)
     a = b + c;  
</pre>

<p>
   should produce a syntax error. 
   
   The correct syntax would be
<p>

<pre>
   if (x != 0)
   {
     a = b + c;	  
   }
</pre>

<p>
  There is no implicit type casting in conditional statements.
  For instance, "if (x)" is not valid if "x" is an int.  You 
  need to write "if ( x != 0)"
<p>

<li>
Functions: <p>

   All functions must be declared with type int or void.
<p>

   Function calls in C-- can appear either on the RHS of an 
   expression or as a statement:
<p>

<pre>
   x = a + foo() + 10;  // foo must return an integer

   foo();               // foo may return either integer or void
</pre>
<p>

   A function call will have either 0 or 1 arguments.
<p>

   Functions may have 'return' statements. There can be one or more 
   return statements in the statement list. The syntax for the 
   return statements are
<p>
    
<pre>
   return; 	// when returns void

   return exp;  // when returns integer 
</pre>
<p>

<li>
Program Syntax:<p>

   A valid C-- program consists of zero or more global 
   variable declarations, followed by one or more function 
   definitions. The body of the functions may contain local
   variable declarations, followed by the code.
<p>

   The function structure will be
<p>

<pre>
   [ int | void ] function_name( 0 or 1 parameters ) 
   { 
     local variable declarations;   // optional 
     statement list; 
   }
</pre>

<p>

<li>
Forward Function Declarations:<p>

   A function has to be defined before a call to it can be made.  
<p>

   For instance, the following code should cause bar() to be
   marked as an undefined function.
<p>

<pre>
   void foo()
   {
     bar(1);
   }
</pre>
<p>

<pre>
   void bar(int x)
   {
     y = x;
   }
</pre>
<p>

   However, we do allow forward function declarations.  They are 
   similar to actual function declarations, except they do not
   contain a function body.  
<p>

   For example, the following code contains a forward declaration 
   of bar(), which allows it to be used before it is actually defined:
<p>
	
<pre>
   void bar( int x );
</pre>
<p>

<pre>
   foo()
   {
     bar();
   }
</pre>
<p>

<pre>
   void bar( int y )
   {
     y = 1;
   }
</pre>
<p>

   Forward declarations specify the function return type and 
   parameter type.  They must match with actual function declaration.
   The name of the parameter in the forward declaration is not relevant.
<p>

<li>Built-in functions<p>

There are three built-in library functions: printInt(), printStr(),
   and printLn().  The compiler will automatically generate code for 
   these functions if they are used.  printInt() takes an int as an 
   argument, printStr() takes a literal constant string, and printLn()
   has no parameters.  
<p>

   For instance:
<p>

<pre>
   int x; 
   printInt(1); printInt(x); printInt(x+1); 
   printStr("foo"); 
   printLn(); 
</pre>

<p>

<li>Scoping<p>

C-- applies nested lexical scoping, where every pair of curly
   brackets creates a new nested scope (and can include new variable
   declarations).  Variables visible include those declared locally 
   and in enclosing scopes.  For instance:
<p>

<pre>
A:   int x;
     foo()
B:      int x,y;
        if (x == 1)   // refers to x declared at B:
        {
C:         int x,z;
           x = y+z;   // refers to x,z declared at C:,
                      //   y declared at B:
        } 
        else 
        {
           int i,j;
           x = 3;     // refers to x declared at B:
                      //   x,z at C: are not visible 
        }
     }
</pre>
 
</ul>

</p><h2>Requirements</h2>

<h3>
Lexical Analyzer:
</h3>

The lexical analyzer should identify the keywords, operators, identifiers,
strings, constants and other necessary characters correctly. You have to
generate the lexical analyzer using JLex, the java lexical analyzer generator.
The JLex specifications are very similar to the lex specifications.
Read the JLex <a href="http://www.cs.princeton.edu/~appel/modern/java/JLex/current/manual.html">manual</a> to learn JLex specifications and syntax.
<p>

You may need to explicitly look for carriage returns on PC-based 
systems, if the %notunix command to the lexer is not working.  You 
can do this by specifying "\r\n" instead of "\n" as the newline.
<p>

  Goals: 
<ul>
<li> find all legal tokens
<li> handle comments
<li> Report the following simple scanning errors using parser.msg():
<ul>
<li> "illegal character <c>" 
<li> "unterminated string"
</ul>
</ul>
<p>

  Tasks:   
<ul>
<li> add comments
<li> extend strings
<li> extend numbers
</ul>
<p>

<h3>
Parser:
</h3>

The parser is generated using the java parser generator, CUP.
CUP specifications are similar to yacc/bison, taking an LALR grammar.
Read the CUP <a href="http://www2.cs.tum.edu/projects/cup/manual.html">manual</a> to learn CUP specifications and syntaxes.
Report simple syntax errors, and attempt to recover. 
<p>

Goals: 
<ul>
<li> Accept all legal C-- syntax 
<li> Report the following simple syntax errors using "error" token and parser.msg():
<ul>
<li> "illegal statement" 
<li> "illegal expression"
<li> "illegal variable declaration"
<li> "missing semicolon"
</ul>
</ul>
<p>

Tasks:  

<ul>
<li> VOID functions
<li> array declarations
<li> multiple variable declarations
<li> nested lexical scoping 
<li> arithmetic, logical, and relational operators
<li> forward function declarations
</ul>
<p>

</p><h2>Project Files</h2>

You have been given a toy parser which parses a subset of 
the C-- language.  You need to enhance them to parse the full
C-- language.  The files are listed below, with a brief description.
All your modifications will be to the files mycc.lex and mycc.cup.
<p>


<ul>
<li>
mycc.lex <p>
The JLex specification file for implementing the scanner. 
          Most of the basic tokens have been added for you.  All you
          need to do is extend it for comments, strings, and better
          handling of identifiers and numbers.
<li>
mycc.cup <p>
The CUP specification file. You need to extend this file in
          order to implement the parser. Most of your changes should be to 
          this file.  A lot of the grammar and actions have been provided.  
<li> 
symTabEntry.java<p>
Code for implementing symbol table entries
          You should not need to modify this file.
<li>
symTab.java<p>
Code for implementing the symbol table 
          You should not need to modify this file.
<li>
expNode.java<p>
Code for storing information with expression nodes
          You should not need to modify this file.
<li>
Yylex.java, parser.java, sym.java<p>
Files created by JLex & CUP
<li>
goAll, goAll.bat<p>
Script for compiling mycc & testing it on test*.in
<li>
goTest, goTest.bat<p>
Script testing mycc on test*.in
<li>
goJar, goJar.bat<p>
Scriptfile for putting mycc.cup & mycc.lex in p1.jar for submission.
<li>
toy*.c<p>
Some sample input C-- programs handled by the toy front end initially provided
<li>
test*.c<p>
Some sample input C-- programs you should try to parse
<li>
test*.log<p>
Log files created by mycc when using the goAll scripts
<li>
test*.out<p>
Some sample output files from a fully implemented front end

</ul>

<h2>Main Classes</h2>


<ul>
<li> parser <p>

Generated by CUP, this is the class which performs the actual
parse.  All action code in your CUP grammar are executed as
methods of class "parser".  Important public fields include 
globalSymTab, currSymTab, and curType.  These fields are used 
to store information to be transferred between different actions 
in CUP.  The "parser" class also contains main(), the starting
point of the user code. You should use the static method msg() 
to report any scanner & parser error messages.

<li> sym <p>

Generated by CUP, this class contains the constants for all
the token in the grammar.  Useful constants include sym.INT,
sym.BOOL, and sym.VOID.  Also used by JLex for the scanner.

<li> Yylex <p>

Generated by JLex, this class implements the scanner.

<li> symTab <p>

Stores all the symbols in a scope as a HashMap.  The 
symbol table also keeps track of its parent.  All
local nested scopes are kept in a children list, 
except for function scopes, which are stored in the 
entry for the function symbol.

<li> symTabEntry <p>

Stores information for each symbol.  Generic information
includes name (as a String) & type (sym.INT, etc).  Also
includes information specific to arrays & functions.  
Important to note the symTabEntry for a function stores
the symTab for that function.

<li> expNode <p>

Stores information as to the type and value of an expression.
Helpful for keeping track of intermediate expressions (e.g., 1+2*4).

</ul>

<h2>Hints and Tips</h2>

<ul>
<li> When implementing your project in Eclipse, you will likely need to 
frequently apply the Refresh command <F5> in order for Eclipse to 
locate the latest files created by JLex, CUP, and your parser. 
<p>

<li> If you examine TestUtils.java, you will see that the 
test scripts 
<ul>
<li> Ignore line numbers and white space
<li> Ignores "Syntax error" warnings
<li> Only checks for the presence of the following error messages (ignoring 
their location and line numbers)
<ul>
<li> "unterminated string"
<li> "illegal expression"
<li> "illegal variable declaration"
<li> "missing semicolon"
</ul>
</ul>
However, we reserve the right to examine the actual output of your parser
when evaluating its correctness.
<p>
<li> You may add checks for additional syntax errors if you wish, but it
should not affect whether you pass any of the public/release/secret tests.
</ul>

<h2>Submission</h2>

You can submit your project in two ways:

<ul> 
<li>
Submit your mycc.lex and mycc.cup files by
first putting both files in a single .zip or .jar archive.
The files should be at the top level of the archive,
not in a subdirectory.  
<p>
You may create a jar archive containing mycc.cup & mycc.lex 
by going to the directory containing your project, then either
execute goJar (or goJar.bat) or type the following command directly:
<p>

<center>
<tt>
jar cf p1.jar mycc.cup mycc.lex
</tt>
</center>
<p>

You can submit the resulting p1.jar archive to 
to the <a href="http://submit.cs.umd.edu/">submit server</a> 
by clicking on the submit link in the column "web submission".

<p>
<img src="submit1.jpg">
</p><p>
 
</p><p>
<img src="submit2.jpg">
</p><p>
 
Select the p1.jar archive using the "Browse" button,
then press the "Submit project!" button.
</p><p>
</p></li><li>

</li><li>
Submit directly by executing a Java program on a computer
with Java and network access.  Use the submit.jar file
from the archive <a href="http://www.cs.umd.edu/class/spring2011/cmsc430/p1/p1.zip">p1.zip</a>,
To submit, go to the directory containing your project, then either
execute goSubmit (or goSubmit.bat) or type the following command directly:
<p>

<center>
<tt>
java -jar submit.jar
</tt>
</center>
<p>

You will be asked to enter your class account and password, then
all files in the directory (and its subdirectories) will be
put in a jar file and submitted to the submit server.
If your submission is successful you will see the message:
</p><p>

</p><center>
<tt>
Successful submission #<submission_number> received for project 2
</submission_number></tt>
</center>
<p>

</p></li></ul>

<h2>Academic Integrity</h2>

<p>

</p><p>
Please <b>carefully read</b> the academic honesty section of the
course syllabus.  In particular, remember that you are not allowed
to show or copy any code for your project, either from the web or 
other students. <b>Any evidence</b> of impermissible cooperation on
projects, use of disallowed materials or resources, or unauthorized
use of computer accounts, <b>will be submitted</b> to the Student
Honor Council, which could result in an XF for the course, or
suspension or expulsion from the University.  Be sure you understand
what you are and what you are not permitted to do in regards to
academic integrity when it comes to project assignments.  These
policies apply to all students, and the Student Honor Council does not
consider lack of knowledge of the policies to be a defense for
violating them.  Full information is found in the course
syllabus---please review it at this time.


</p></td>
</tr></tbody></table>

</body></html>
